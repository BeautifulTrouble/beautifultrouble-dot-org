var give_scripts,give_global_vars;!function(e){e.getQuery=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?&]"+e+"=([^&#]*)",t=new RegExp(a),i=t.exec(window.location.href);return null!==i?i[1]:!1}}(jQuery),jQuery(function(e){function a(){var a=e(this),t=a.parents("form");if("card_state"!=a.attr("id")){t.find("#card_state").empty().append('<option value="1">'+give_global_vars.general_loading+"</option>").prop("disabled",!0);var i={action:"give_get_states",country:a.val(),field_name:"card_state"};e.ajax({type:"POST",data:i,url:give_global_vars.ajaxurl,xhrFields:{withCredentials:!0},success:function(e){if("nostates"==e){var a='<input type="text" id="card_state" name="card_state" class="cart-state give-input required" value=""/>';t.find('input[name="card_state"], select[name="card_state"]').replaceWith(a)}else t.find('input[name="card_state"], select[name="card_state"]').replaceWith(e);d.trigger("give_checkout_billing_address_updated",[e,t.attr("id")])}}).fail(function(e){window.console&&window.console.log&&console.log(e)})}return!1}function t(){give_form=e("form.give-form"),give_form.each(function(){var a=e(this).find(".card-number"),t=e(this).find(".card-cvc"),i=e(this).find(".card-expiry");return 0===a.length?!1:(a.payment("formatCardNumber"),t.payment("formatCardCVC"),void i.payment("formatCardExpiry"))})}function i(e){return accounting.formatMoney(e,{symbol:"",decimal:give_global_vars.decimal_separator,thousand:give_global_vars.thousands_separator,precision:give_global_vars.number_decimals}).trim()}function n(e){return Math.abs(parseFloat(accounting.unformat(e,give_global_vars.decimal_separator)))}function r(a){var t=a.parents("form"),i=a.val(),n=a.data("price-id"),r=t.find(".give-currency-symbol").text();if(e(a).parents(".give-donation-levels-wrap").find(".give-default-level").removeClass("give-default-level"),e(a).addClass("give-default-level"),t.find("#give-amount").removeClass("invalid-amount"),"custom"===i)return t.find("#give-amount").val("").focus(),!1;n||(n=a.find("option:selected").data("price-id")),t.find(".give-updating-price-loader").stop().fadeIn().fadeOut(),t.find("input[name=give-price-id]").val(n),t.find("input#give-amount").val(i),t.find("span#give-amount").text(i);var o=r+i;"after"==give_global_vars.currency_pos&&(o=i+r),t.find(".give-final-total-amount").data("total",i).text(o)}function o(){var a=e.getQuery("form-id"),t=e.getQuery("payment-mode");if(!a||!t)return!1;var i=e("body").find("#give-form-"+a+"-wrap"),n=i.find("form.give-form"),r=i.hasClass("give-display-modal"),o=i.hasClass("give-display-reveal");n.find("#give-gateway-radio-list label").removeClass("give-gateway-option-selected"),n.find("input[name=payment-mode][value="+t+"]").prop("checked",!0).parent().addClass("give-gateway-option-selected"),r?e.magnificPopup.open({mainClass:"give-modal",items:{src:n,type:"inline"},callbacks:{open:function(){e(".mfp-content").outerWidth()>=500&&e(".mfp-content").addClass("give-responsive-mfp-content")},close:function(){n.removeClass("mfp-hide")}}}):o&&(n.find(".give-btn-reveal").hide(),n.find("#give-payment-mode-select, #give_purchase_form_wrap").slideDown())}var d=e(document);d.on("change","#give_cc_address input.card_state, #give_cc_address select",a),o(),t(),d.on("give_gateway_loaded",function(){t()}),e.fn.toggleError=function(e){return this.toggleClass("error",e),this.toggleClass("valid",!e),this},d.on("keyup change",".card-number, .card-cvc, .card-expiry",function(){var a=e(this),t=a.parents("form.give-form"),i=a.attr("id"),n=t.find(".card-number"),r=t.find(".card-cvc"),o=t.find(".card-expiry"),d=e.payment.cardType(n.val());if(i.indexOf("card_number")>-1){var l=t.find(".card-type");null===d?(l.removeClass().addClass("off card-type"),a.removeClass("valid").addClass("error")):l.removeClass("off").addClass(d),n.toggleError(!e.payment.validateCardNumber(n.val()))}if(i.indexOf("card_cvc")>-1&&r.toggleError(!e.payment.validateCardCVC(r.val(),d)),i.indexOf("card_expiry")>-1){o.toggleError(!e.payment.validateCardExpiry(o.payment("cardExpiryVal")));var s=o.payment("cardExpiryVal");t.find(".card-expiry-month").val(s.month),t.find(".card-expiry-year").val(s.year)}}),d.on("submit","#give_payment_mode",function(){var a=e("#give-gateway option:selected").val();return 0==a?(alert(give_global_vars.no_gateway),!1):void 0}),d.on("click","#give-payment-mode-select input",function(){e("#give-payment-mode-select label.give-gateway-option-selected").removeClass("give-gateway-option-selected"),e("#give-payment-mode-select input:checked").parent().addClass("give-gateway-option-selected")}),d.on("focus",".give-donation-amount .give-text-input",function(a){var t=e(this).parents("form");e(this).removeClass("invalid-amount"),e(this).data("amount",n(e(this).val())),e(this).parent(".give-donation-amount").addClass("give-custom-amount-focus-in"),t.find(".give-default-level, .give-radio-input").removeClass("give-default-level"),t.find(".give-btn-level-custom").addClass("give-default-level"),t.find(".give-radio-input").prop("checked",!1),t.find(".give-radio-input.give-radio-level-custom").prop("checked",!0),t.find(".give-select-level").prop("selected",!1),t.find(".give-select-level .give-donation-level-custom").prop("selected",!0)}),d.on("blur",".give-donation-amount .give-text-input",function(a){var t=e(this).data("amount"),r=n(e(this).val()),o=i(r);e(this).val(o),(!e.isNumeric(r)||0>=r)&&e(this).addClass("invalid-amount"),t!==r&&(e(this).parents("form").find(".give-final-total-amount").data("total",r).text(o),e(this).next(".give-updating-price-loader").stop().fadeIn().fadeOut()),e(this).parent(".give-donation-amount").removeClass("give-custom-amount-focus-in")}),d.on("click touchend",".give-donation-level-btn",function(a){a.preventDefault(),r(e(this))}),d.on("click touchend",".give-radio-input-level",function(a){r(e(this))}),d.on("change",".give-select-level",function(a){r(e(this))})});